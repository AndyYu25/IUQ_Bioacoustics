# IUQ_Bioacoustics
CSE8803-IUQ (Introduction to Uncertainty Quantification) term project on performing uncertainty quantification with respect to deep learning approaches to classifying bioacoustic sounds. 

## Code Files

dataset/dataCollection.py is the script to scrape the entirety of the Watkins Marine Mammal Database.
dataset/preprocessing.py is the script to convert the downloaded sound files into the preprocessed mel-spectrograms (stored as tensors)
dataset/dataVisualizer.py is a script to visualize mel-spectrograms from the generated tensors.
baseline_model.py contains the model architecture for the InceptionNet baseline as well as the modified Bayesian Neural Network
dataset.py contains the PyTorch dataset generator for all models.
evaluation.py contains the code for evaluating the baseline, deep ensemble, and MC dropout approaches (BNN evaluation implemented within notebook)
baseline.ipynb contains the code to train and evaluate the base InceptionNet model, without any UQ methods applied.
bayesian_bnn.ipynb contains the code to train and evaluate the Bayesian Neural Network.
ensemble.ipynb contains the code to train and evaluate the deep ensemble.
mcdropout.ipynb contains the code to train and evaluate the Monte Carlo dropout model.


## Intallation & Execution (Google Colab)

All four notebooks comprising of the baseline model (baseline.ipynb), Monte Carlo dropout (mcdropout.ipynb), deep ensemble (ensemble.ipynb), and the Bayesian neural network (bayesian_bnn.ipynb) can be directly uploaded to CoLab and run directly from there to replicate results. 
The requisite package, other repository files, and pre-processed data will be downlaoded using  the 1st 3 cells of each notebook. A GPU is highly suggested due to the cost of the training process.

## Installation (Other)

After cloning the repository, run `pip install -r requirements.txt` to install all requisite libraries. Again, a GPU is highly suggested due to the cost of the training process.

WARNING: The code currently breaks for Windows OS due to the fact that Windows cannot handle pickling a lambda transform used for the dataset.

## Obtainig Processed Data

Data can be regenerated by running dataset/dataCollection.py and dataset/preprocessing.py in succession. Alterantively, the preprocessed data can be downloded from [here](https://drive.google.com/file/d/1WUgfFip5xvxQV-RqWRaHCRYuCwqBCGL7/view), or the `gdown` script (below) can be used to download directly using the file ID.

```console
pip3 install gdown
gdown 1WUgfFip5xvxQV-RqWRaHCRYuCwqBCGL7
unzip preprocessed.zip
```
